# 054 Takahashi Number

## 注意
本フォルダ内には, `Cycle.java` `Doubling.java`という2種類の解答ファイルがあります.
実際に手元で実行する際にはファイル名を`Main.java`に変更しないと正しく動作しません.

## ダブリング解法
公式解説は周期に基づく探索の打ち切りを行っていましたが, ここでは「ダブリング」による解法を実装しました. 

前処理として, コード内の配列`trans`に, 遷移に関する情報をまとめます. `trans[n][d]` には, $n$ からはじめて$2^d$回の遷移を行ったあとの値が格納されます.

計算にはDPを用います. 「$n$から$2^d$回遷移した先」とは, 「$n$から$2^{d-1}$回遷移して, そこからさらに$2^{d-1}$回遷移した先」と言い換えられるので, 以下のようにして値を求めることができます.
```java
trans[n][d] = trans[trans[n][d-1]][d-1];
```

この情報が正しく求められていれば, 任意の$K$について$K$回遷移後の値を$O(logK)$時間で計算できます.

例えば入力例として以下のようなものを考えます.
```
N = 13
K = 10
```
この場合, $K$を2進数で表すと `1010` になります. $K = 2^3 + 2^1$というわけですね. よって, 10回遷移した先というのは「8回遷移して, そのあと2回遷移した先」と分解することができるので `trans` に格納した情報から計算を進められます.
どのタイミングで遷移を確認するかはビット演算を用いて確認することができます. 合計の計算量は(前処理のほうが重いので)$O(N \log K)$となります.