# Q005 Restricted Digits

## 解法
まず, 特殊ケースとして Nが2の累乗の形で表される場合について考えます. `N=2^p` のとき, `2^p`桁の整数の中で条件を満たすものを数え上げることになりますが, ここでこの`2^p`桁を前半と後半に分けてみるとそれぞれの部分が`2^(p-1)`桁なので, 再帰的に解くことができそうな気持ちになります.

もう少し厳密に記述しましょう. 「条件を満たす`2^(p-1)`桁の数のうち, `B`で割った余りが`b`になるものの数」を全ての`b`について求めることができているとしたとき, 「条件を満たす`2^p`桁の数のうち, `B`で割った余りが`b`になるものの数」を計算したいです. `2^p`のうちの前半`2^(p-1)`桁をBで割った余りが`j`, 後半`2^(p-1)`桁をBで割った余りが`k`であるとき, この`2^p`桁の数をBで割った余りは`j * 10^(2^(p-1)) + k`をBで割った余りと一致します. これを全ての`(j,k)`の組に対して計算することで, この部分問題を解くことができました. DP推移を1段階進めるのにO(B^2)かかりますが, 高々60段ほど計算すれば十分なので時間制限には間に合います.

では, `N`が一般の場合について考えます. `N`の2進数展開を利用することで, `N`を高々60個程度の2冪の数の和で表すことができます(例えば100 = 2^6 + 2^5 + 2^2). 2冪の桁数に関する情報は前述の方法で計算できるので, それらのうち必要なものを抜き出して同様の手法により連結させると一般の`N`に対して問題を解くことができます.